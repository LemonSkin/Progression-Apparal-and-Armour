<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <!-- Chainmail -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/label</xpath>
    <value>
      <label>light hauberk</label>
    </value>
  </Operation>
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/recipeMaker/recipeUsers</xpath>
    <order>Append</order>
    <value>
      <li>DankPyon_Anvil</li>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/recipeMaker/skillRequirements/Crafting</xpath>
    <value>
      <Crafting>6</Crafting>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/costStuffCount</xpath>
    <value>
      <costStuffCount>50</costStuffCount>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/statBases/WorkToMake</xpath>
    <value>
      <WorkToMake>10000</WorkToMake>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/statBases/Mass</xpath>
    <value>
      <Mass>2</Mass>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/statBases/EquipDelay</xpath>
    <value>
      <EquipDelay>4</EquipDelay>
    </value>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/apparel/bodyPartGroups/li[.="Arms"]</xpath>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chainmail"]/apparel/bodyPartGroups/li[.="Legs"]</xpath>
  </Operation>
  <!-- Light Plate Armor -->
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/recipeMaker/recipeUsers</xpath>
    <order>Append</order>
    <value>
      <li>DankPyon_Anvil</li>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/costStuffCount</xpath>
    <value>
      <costStuffCount>150</costStuffCount>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/statBases/WorkToMake</xpath>
    <value>
      <WorkToMake>22000</WorkToMake>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/statBases/StuffEffectMultiplierArmor</xpath>
    <value>
      <StuffEffectMultiplierArmor>0.65</StuffEffectMultiplierArmor>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/statBases/StuffEffectMultiplierInsulation_Cold</xpath>
    <value>
      <StuffEffectMultiplierInsulation_Cold>0.15</StuffEffectMultiplierInsulation_Cold>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/statBases/StuffEffectMultiplierInsulation_Heat</xpath>
    <value>
      <StuffEffectMultiplierInsulation_Heat>0</StuffEffectMultiplierInsulation_Heat>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_LightPlateArmor"]/equippedStatOffsets/MoveSpeed</xpath>
    <value>
      <MoveSpeed>-0.4</MoveSpeed>
    </value>
  </Operation>
  <!-- Plate Shoulderpads -->
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/recipeMaker/recipeUsers</xpath>
    <order>Append</order>
    <value>
      <li>DankPyon_Anvil</li>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/recipeMaker/skillRequirements/Crafting</xpath>
    <value>
      <Crafting>9</Crafting>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/statBases/WorkToMake</xpath>
    <value>
      <WorkToMake>7200</WorkToMake>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/statBases/MaxHitPoints</xpath>
    <value>
      <MaxHitPoints>250</MaxHitPoints>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/statBases/Mass</xpath>
    <value>
      <Mass>2</Mass>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/statBases/StuffEffectMultiplierArmor</xpath>
    <value>
      <StuffEffectMultiplierArmor>0.73</StuffEffectMultiplierArmor>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/statBases/StuffEffectMultiplierInsulation_Cold</xpath>
    <value>
      <StuffEffectMultiplierInsulation_Cold>0.15</StuffEffectMultiplierInsulation_Cold>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateShoulderpads"]/statBases/EquipDelay</xpath>
    <value>
      <EquipDelay>2</EquipDelay>
    </value>
  </Operation>
  <!-- Plate Helmet -->
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateHelmet"]/recipeMaker/recipeUsers</xpath>
    <order>Append</order>
    <value>
      <li>DankPyon_Anvil</li>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateHelmet"]/recipeMaker/skillRequirements/Crafting</xpath>
    <value>
      <Crafting>7</Crafting>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateHelmet"]/statBases/WorkToMake</xpath>
    <value>
      <WorkToMake>14600</WorkToMake>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateHelmet"]/statBases/Mass</xpath>
    <value>
      <Mass>3.5</Mass>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateHelmet"]/statBases/StuffEffectMultiplierArmor</xpath>
    <value>
      <StuffEffectMultiplierArmor>0.73</StuffEffectMultiplierArmor>
    </value>
  </Operation>
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_PlateHelmet"]/equippedStatOffsets/ShootingAccuracyPawn</xpath>
    <value>
      <ShootingAccuracyPawn>-0.5</ShootingAccuracyPawn>
    </value>
  </Operation>
  <!-- Remove tings -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Chestplate"]</xpath>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Handwear_PlateGloves"]</xpath>
  </Operation>
  <!-- Fix VARME Royalty patch before removing VARME plate boots -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Full Armor - Hands and Feet</li>
      <li>Combat Extended</li>
    </mods>
    <nomatch Class="PatchOperationReplace">
      <xpath>/Defs/PawnKindDef[@Name="ImperialFighterBase"]/apparelRequired/li[.="VAE_Footwear_PlateBoots"]</xpath>
      <value>
        <li>DankPyon_Footwear_BootsPlate</li>
      </value>
    </nomatch>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Footwear_PlateBoots"]</xpath>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_QuiltedVest"]</xpath>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="VAE_Apparel_Gambeson"]</xpath>
  </Operation>
  <!-- Rewire military clothing if it exists and then delete VAE LeatherTanning research -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Vanilla Apparel Expanded</li>
    </mods>
    <nomatch Class="PatchOperationRemove">
      <xpath>Defs/ResearchProjectDef[defName="VAE_MilitaryClothing"]/prerequisites</xpath>
      <success>Always</success>
    </nomatch>
  </Operation>
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ResearchProjectDef[defName="VAE_LeatherTanning"]</xpath>
  </Operation>
</Patch>
